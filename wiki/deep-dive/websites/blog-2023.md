# xzos.net 博客 - 2023年

> **文章数量**: 2 篇  
> **主题**: Android开发、项目规划

---

## 文章列表

### 1. 代码即操作系统（UpgradeAll 2 开发计划）

**日期**: 2023-10-18  
**URL**: https://xzos.net/blog/code-as-operating-system-upgradeall-2-development-plan/  
**分类**: 开发/架构/规划

#### 摘要

提出一个从程序员角度进行运维的新构建系统理念，以及 UpgradeAll 2 的开发方向。

#### 核心观点

**问题分析**:
- 备份还原无法理解数据的意义
- DNS hosts 与软件缓存被同等对待
- Ansible/Terraform 的"幂等性"是"自欺欺人"

**现状批评**:
- 操作系统不会随 Ansible 停止而关机
- 删除配置代码并重运行不会回滚副作用
- 导致"配置偏移"问题

**提出的解决方案**:

新系统特性要求：
- 面对终端普通用户
- 面对目标（面对功能，而非软件）
- 可回滚（删除操作 → 自动回滚）
- 单机应用优先
- 与现有运维技术兼容（初版用 Ansible）
- 可自动检查现有系统并生成配置代码
- 灵活的逻辑代码

#### UpgradeAll 2 愿景

- 从源码编译（使用开发者未合并的分支）
- 面对开发者友好（可编程更新流程）
- 面对用户友好（只关心功能，不找应用）
- 促进 Android 应用开放化

#### 技术深度

展示了对运维领域的深入思考：
- NixOS 的优缺点分析
- OCI 容器化的局限性
- 声明式配置 vs 命令式配置

#### 技术标签
`架构设计` `UpgradeAll` `运维` `Ansible` `NixOS` `配置管理`

---

### 2. 手动线刷任意 Android ROM

**日期**: 2023-04-22  
**URL**: https://xzos.net/blog/flash-android-rom-by-fastboot-payload_dumper/  
**分类**: Android/系统

#### 摘要

通过 Fastboot 与 payload_dumper 工具，在任意时刻刷入任意 Android ROM。以 Redmi K40 刷入 crDroid OS 为例。

#### 技术背景

**问题**: OTA 更新遇到错误
```
Error applying update: 7 (ErrorCode:: kInstallDeviceOpenError)
```

**原因**: A/B 分区的 OTA 包没有 updater-script 文件

#### 解决方案

**工具**: [payload_dumper](https://github.com/vm03/payload_dumper)

**流程**:
1. 解压 ROM 获取 payload.bin
2. 使用 payload_dumper 解码
   ```bash
   podman run --rm -v $PWD:/data -it vm03/payload_dumper /data/payload.bin --out /data/output
   ```
3. 进入 fastbootd 模式（非 bootloader）
4. 逐个刷入 img 文件
   ```bash
   for img in (ls *.img)
       set img_name (basename $img .img)
       fastboot flash $img_name $img
   end
   ```

**注意事项**:
- 使用 fastbootd 而非 bootloader 模式
- 建议使用 NeoBackup 定期备份

#### 技术标签
`Android` `Fastboot` `payload_dumper` `ROM` `刷机`

---

## 2023年技术主题

| 主题 | 文章数 | 关键词 |
|------|--------|--------|
| 架构设计 | 1 | UpgradeAll 2、运维、可回滚 |
| Android | 1 | Fastboot、ROM刷入 |

---

**文档版本**: v1.0  
**最后更新**: 2026-02-04
