# xzos.net 博客 - 2026年

> **文章数量**: 3 篇  
> **主题**: AI时代思考、并发/MCP、媒体处理

---

## 文章列表

### 1. AI 时代的乐观可失败队列

**日期**: 2026-02-04  
**URL**: https://xzos.net/blog/optimistic-fallible-queue-in-ai-era/  
**分类**: AI/并发/MCP

#### 摘要

源于为 MCP 官方 Memory Server 修复并发写入问题 (PR #3286) 的深度思考。当 AI 成为用户，软件的本质变成了提供一种百分百的概率。

#### 核心论点

**乐观可失败队列设计理念**:
- AI 天生处理不确定性，MCP 工具只需"尽力而为"
- 只给写加锁，允许读写乱序
- 关键约束：返回成功的一定成功，失败一定返回失败

**技术选择**:
| 方案 | 问题 |
|------|------|
| 悲观锁 | 最保守，但忘记了 MCP 是给 AI 准备的 |
| 内存锁 | 多进程场景无效 (stdio 模式) |
| 文件锁 | ✅ 跨进程共享，NFS 兼容 |

#### 技术深度

**多进程架构问题**:
```
Claude Code A → mcp-server-memory (Process A) ─┐
Claude Code B → mcp-server-memory (Process B) ─┼→ memory.json (RACE!)
Claude Code C → mcp-server-memory (Process C) ─┘
```

**NFS 兼容性配置**:
- stale 超时 60s (匹配 NFS acregmax)
- heartbeat 10s (保持锁"新鲜")
- 指数退避重试 (50ms 起步)

**原子写入权衡**:
- 最初自己实现（先写临时文件再 rename），但文件权限、并发临时文件命名等边界情况太多
- 改用 write-file-atomic 库
- 关闭 fsync：Windows 上开启后单次写入从 3ms → 300ms，高压力下失败更多
- 权衡：接受极小断电风险，换取更少超时失败
- "保证文件系统断电后一致性，是操作系统的事，不是应用该做的"

**测试设计**:
1. 压力测试（最初叫"混沌测试"，后改名更准确——混沌测试通常指随机注入故障，这里是可控高并发压力）：
   - 单进程：10 线程 async 1000 写入
   - 多进程：5 个独立进程 × 2000 次写入（模拟真实多 AI 客户端）
   - 判断标准：成功的数据都在文件里且只有成功数据
2. 混沌测试思想（未实现代码）：进程写入一半被杀死 → 文件损坏场景

**压力测试的必须性** - 避免失败螺旋：
- 重试导致的自我 DDoS
- 状态更新失败但无法自动降级 → 参考 [Cloudflare 2025年11月事故](https://blog.cloudflare.com/18-november-2025-outage/)

#### 金句

> "AI 时代的软件，是从确定性变为概率，从代码变成提示词。"
>
> "MCP 工具可以不存在，但是 AI 还是最终会用"概率""发明"一个不稳定的 MCP，所以 AI 时代，软件的本质是提供一种百分百的概率。"
> 
> "乐观，但不能陷入失败螺旋。"

#### 关联项目
- **PR**: modelcontextprotocol/servers#3286 (MCP 文件锁)
- **相关 PR**: #3060 (内存锁方案的局限)

#### 技术标签
`MCP` `并发` `文件锁` `NFS` `原子写入` `压力测试` `AI原生软件`

---

### 2. AI 时代的脑腐症

**日期**: 2026-02-02  
**URL**: https://xzos.net/blog/brain-rot-in-ai-era/  
**分类**: AI/思考

#### 摘要

当 AI 生成内容泛滥成灾，刷手机变成了"粪坑里找金子"。文章探讨了 AI 时代对人类注意力和专注力的影响。

#### 核心观点

- 注意力从"被吸引"变成"被掠夺"
- 无限滑动如同老虎机的拉杆机制
- 失去专注力导致更加无趣的人生
- 解决方案：温习前 AI 时代内容、感受"现实"
- 每一代人都会以上一代人意料不到的方式解决问题

#### 金句

> "每个人都希望获取你的注意力，从报纸时代就开始了。"
> 
> "所以人类文明还能前进，但你，只能深陷沼泽。"

#### 技术标签
`AI` `注意力经济` `数字健康` `思考`

---

### 3. 批量修复 DJI Mimo 导出照片/视频的拍摄时间

**日期**: 2026-01-04  
**URL**: https://xzos.net/blog/dji-mimo-photo-date-fix/  
**分类**: 工具/自动化

#### 摘要

使用 osxphotos timewarp 命令，从文件名中提取正确的拍摄时间并批量修复 Apple Photos 中的日期。

#### 技术要点

**DJI Mimo 文件命名结构**:
```
dji_mimo_20260101_151718_20260101151719_1767262128881_photo.jpg
│        │        │      │              │             │
│        │        │      │              │             └─ 类型标识
│        │        │      │              └─ Unix 时间戳（毫秒）
│        │        │      └─ 第二个时间戳：实际拍摄时刻
│        │        └─ 第一个时间戳的时间部分
│        └─ 第一个时间戳的日期部分
└─ 固定前缀
```

**关键命令**:
```bash
osxphotos timewarp \
  --album "DJI Album" \
  --parse-date "dji_mimo_*_*_%Y%m%d%H%M%S" \
  --timezone "Asia/Shanghai" \
  --verbose
```

**前置条件**:
- macOS 环境（可用 quickemu 或 ultimate-macOS-KVM 虚拟机）
- 安装 osxphotos: `brew install osxphotos`

#### 技术深度
- strptime 格式解析
- 通配符匹配技巧
- iCloud 账号同步限制

#### 技术标签
`macOS` `osxphotos` `DJI` `媒体处理` `Python` `自动化`

---

## 2026年技术主题

| 主题 | 文章数 | 关键词 |
|------|--------|--------|
| AI/并发 | 1 | MCP、文件锁、乐观队列 |
| AI 思考 | 1 | 注意力、数字健康 |
| 媒体处理 | 1 | osxphotos、DJI、时间修复 |

---

**文档版本**: v1.1  
**最后更新**: 2026-02-05
